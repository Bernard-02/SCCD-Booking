<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A5F編號區租借 - SCCD 媒傳系平台</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Noto+Sans+TC:wght@100..900&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="css/arrows.css" />
    <link rel="stylesheet" href="css/breadcrumb.css" />
    <link rel="stylesheet" href="css/copyright.css" />
    <link rel="stylesheet" href="css/common.css" />
    <link rel="stylesheet" href="css/mobile-menu.css" />

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.7/dist/gsap.min.js"></script>
    <script src="cart-manager.js"></script>
    <script src="js/mobile-menu.js"></script>
    <script src="js/button-animations.js"></script>
    <script src="js/copyright-easter-egg.js"></script>
    <script src="js/cart-sync.js"></script>
    
    <!-- 箭頭動畫樣式 -->
    <style>
      /* 只在桌面版顯示 hover 效果 */
      @media (hover: hover) and (pointer: fine) {
        .arrow-link:hover .arrow-icons-wrapper {
          transform: translateY(-1em);
        }
        
        /* Footer 連結 hover 效果 */
        .footer-link:hover {
          opacity: 0.6;
        }
        
        /* Header 導航連結 hover 效果 */
        .nav-link:hover {
          opacity: 0.6;
        }
      }
      
      /* 展開式元件樣式 */
      .accordion-item {
        border-bottom: 1px solid white;
        padding: 0.6rem 0; /* 增加分類間距 */
      }
      
      .accordion-item:last-child {
        border-bottom: none;
      }
      
      .accordion-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .accordion-content {
        height: 0;
        overflow: hidden;
        padding: 0;
      }
      
      .accordion-content.expanded {
        padding-bottom: 20px; /* 增加底部間距 */
      }
      
      .expand-icon {
        width: 24px;
        height: 24px;
        cursor: pointer;
      }
      
      .accordion-content-inner {
        opacity: 0;
        margin-top: 16px; /* 押金群組往下移動 */
      }
      
      /* 地圖區域樣式 */
      .map-container {
        display: flex;
        align-items: center; /* 垂直居中對齊 */
        justify-content: center; /* 水平居中對齊 */
        height: 100%;
        padding: 0;
        overflow: hidden;
      }
      
      /* 玻璃牆和柱子的特殊滾動容器 */
      .map-container.scrollable {
        overflow: auto;
        align-items: flex-start; /* 改為頂部對齊 */
        justify-content: center; /* 保持水平居中 */
      }
      
      .map-svg {
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        cursor: pointer;
      }
      
      /* 玻璃牆和柱子的SVG不縮放，保持原始比例 */
      .map-svg.no-scale {
        width: auto;
        height: auto;
        max-width: none;
        max-height: none;
        object-fit: none;
        flex-shrink: 0; /* 防止被壓縮 */
      }
      
      /* SVG 格子樣式 */
      .grid-cell {
        cursor: pointer;
        transition: all 0.2s ease;
        transform-box: fill-box;
        transform-origin: center center;
      }
      
      /* 只在桌面版顯示 hover 效果 */
      @media (hover: hover) and (pointer: fine) {
        .grid-cell:hover {
          transform: scale(1.05);
          filter: brightness(1.1);
        }
      }
      
      .grid-cell.selected {
        fill: #00ff80 !important;
      }
      
      .grid-cell.booked {
        fill: #ff448a !important;
        cursor: not-allowed;
      }
      
      /* 只在桌面版顯示 hover 效果 */
      @media (hover: hover) and (pointer: fine) {
        .grid-cell.booked:hover {
          transform: none;
          filter: none;
        }
      }
      
      /* 可租借格子顏色 */
      .grid-cell:not(.selected):not(.booked) {
        fill: #898989 !important;
      }
      
      /* 後陽台SVG特殊縮放 */
      #area-map[data-area="back-balcony"] {
        transform: scale(0.6);
        transform-origin: center center;
      }
      
      /* 阻止頁面滾動 */
      body {
        overflow: hidden;
      }
      
      /* 狀態指示器樣式 */
      .status-indicators {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-bottom: 2rem;
      }
      
      .status-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      
      .status-box {
        width: 1.2rem;
        height: 1.2rem;
      }
      
      .status-available {
        background-color: #898989;
      }
      
      .status-booked {
        background-color: #ff448a;
      }
      
      .status-selected {
        background-color: #00ff80;
      }
      
      /* SVG 點擊區域樣式 */
      .clickable-area {
        cursor: pointer;
        transition: fill 0.2s ease;
      }
      
      /* 只在桌面版顯示 hover 效果 */
      @media (hover: hover) and (pointer: fine) {
        .clickable-area:hover {
          opacity: 0.8;
        }
      }
      
      .clickable-area.selected {
        fill: #00ff80 !important;
      }
      
      .clickable-area.booked {
        fill: #ff448a !important;
        cursor: not-allowed;
      }
      
      /* Tooltip 樣式 */
      #grid-tooltip {
        position: fixed;
        background-color: white;
        color: black;
        font-family: 'Inter', sans-serif;
        font-size: 0.75rem; /* 從text-sm改為text-xs */
        font-weight: 400;
        padding: 3px 8px; /* 減少上下padding */
        border-radius: 0; /* 移除倒角 */
        pointer-events: none;
        z-index: 1000;
        opacity: 0;
        transform: translate(10px, -30px); /* 偏移到滑鼠右上角 */
        transition: opacity 0.2s ease;
      }
      
      #grid-tooltip.show {
        opacity: 1;
      }
      
      /* 響應式佈局 */
      @media (max-width: 767px) {
        .mobile-title-section {
          text-align: center;
          margin-bottom: 2rem;
        }
      }
      
      /* 確保大於768px時隱藏手機版選單 */
      @media (min-width: 768px) {
        .mobile-menu { 
          display: none !important; 
        }
      }
    </style>
  </head>

  <body class="bg-black text-white flex flex-col h-screen">
    <header class="py-6">
      <div class="container mx-auto flex justify-between items-center px-6 md:px-4">
        <div class="flex items-center">
          <a href="index.html" class="logo-link mr-10">
            <div class="font-['Inter',_sans-serif] logo text-base font-medium">
              SCCD
            </div>
          </a>

          <!-- 桌面版導航 -->
          <nav class="desktop-nav">
            <ul class="flex space-x-10">
              <li>
                <a
                  href="booking.html"
                  class="font-['Inter',_sans-serif] text-base font-medium transition-colors nav-link"
                  >BOOKING</a
                >
              </li>
              <li>
                <a
                  href="resources.html"
                  class="font-['Inter',_sans-serif] text-base font-medium transition-colors nav-link"
                  >RESOURCES</a
                >
              </li>
            </ul>
          </nav>
        </div>
        <div class="flex items-center space-x-5">
          <a
            href="rental-list.html"
            id="cart-link"
            class="font-['Inter',_sans-serif] text-base font-medium transition-colors nav-link hidden md:block"
            >(<span id="cart-count">0</span>) CART</a
          >
          <a
            href="login.html"
            id="login-btn"
            class="login-btn border text-white rounded-[30px] transition-colors font-['Inter',_sans-serif] font-regular text-sm arrow-link button-animated hidden md:flex"
            style="position: relative; overflow: hidden;"
            >
            <div class="button-bg-fill" style="position: absolute; bottom: 0; left: 0; width: 100%; height: 0; background-color: white; z-index: 1; border-radius: 30px;"></div>
            <span style="position: relative; z-index: 2;">LOG IN</span>
            <div class="arrow-container" style="position: relative; z-index: 2;">
              <div class="arrow-icons-wrapper">
                <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
                <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
              </div>
            </div>
          </a>
          
          <!-- 手機版 CART 按鈕 -->
          <a
            href="rental-list.html"
            id="mobile-cart-link"
            class="font-['Inter',_sans-serif] text-base font-normal transition-colors nav-link md:hidden"
            >(<span id="mobile-cart-count">0</span>) CART</a
          >
          
          <!-- 手機版選單按鈕 -->
          <button class="md:hidden font-['Inter',_sans-serif] text-base" id="mobile-menu-btn">
            <span class="text-white" id="menu-btn-text">MENU</span>
          </button>
        </div>
      </div>
    </header>

    <main class="flex-grow flex flex-col pt-[3vh] pb-[2vh] overflow-hidden">
      <!-- Breadcrumb - 只在桌面版顯示 -->
      <nav class="breadcrumb hidden md:block">
        <a href="index.html" class="breadcrumb-item">首頁</a>
        <span class="breadcrumb-separator">/</span>
        <a href="booking.html" class="breadcrumb-item">租借日期</a>
        <span class="breadcrumb-separator">/</span>
        <a href="bookingresources.html" class="breadcrumb-item">租借資源</a>
        <span class="breadcrumb-separator">/</span>
        <a href="space.html" class="breadcrumb-item">租借空間</a>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item">A5F編號區</span>
      </nav>
      
      <!-- 桌面版佈局 -->
      <div class="w-full px-[6%] flex-grow flex-col overflow-hidden hidden md:flex">
        <!-- 頁面標題 -->
        <div class="mb-6">
          <h1 class="text-4xl font-['Noto_Sans_TC',_sans-serif] font-medium mb-4 mt-2">
            A5F編號區
          </h1>
        </div>
        
        <div class="flex gap-6 flex-grow overflow-hidden"> <!-- 減少gap讓SVG更大 -->
          <!-- 左側：區域列表 -->
          <div class="w-1/5 overflow-y-auto"> <!-- 增加左側padding -->
            <!-- 中庭 -->
            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion('courtyard')">
                <h2 class="text-xl font-['Noto_Sans_TC',_sans-serif] text-white font-medium">中庭</h2>
                <svg class="expand-icon plus" id="icon-courtyard" viewBox="0 0 24 24">
                  <line x1="4" y1="12" x2="20" y2="12" stroke="white" stroke-width="1"/>
                  <line x1="12" y1="4" x2="12" y2="20" stroke="white" stroke-width="1"/>
                </svg>
              </div>
              <div class="accordion-content" id="content-courtyard">
                <div class="accordion-content-inner space-y-4">
                  <div class="space-y-2">
                    <div class="text-sm font-['Inter',_sans-serif] font-normal tracking-wide text-zinc-300">押金/塊</div>
                    <div class="text-3xl font-['Inter',_sans-serif] font-normal text-white tracking-wide">NT1,000</div>
                  </div>
                  <div>
                    <p class="text-sm font-['Noto_Sans_TC',_sans-serif] text-white leading-relaxed">
                      中庭區域適合展覽和大型活動，空間開闊，採光良好。
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- 走廊 -->
            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion('corridor')">
                <h2 class="text-xl font-['Noto_Sans_TC',_sans-serif] text-white font-medium">走廊</h2>
                <svg class="expand-icon plus" id="icon-corridor" viewBox="0 0 24 24">
                  <line x1="4" y1="12" x2="20" y2="12" stroke="white" stroke-width="1"/>
                  <line x1="12" y1="4" x2="12" y2="20" stroke="white" stroke-width="1"/>
                </svg>
              </div>
              <div class="accordion-content" id="content-corridor">
                <div class="accordion-content-inner space-y-4">
                  <div class="space-y-2">
                    <div class="text-sm font-['Inter',_sans-serif] font-normal tracking-wide text-zinc-300">押金/塊</div>
                    <div class="text-3xl font-['Inter',_sans-serif] font-normal text-white tracking-wide">NT1,000</div>
                  </div>
                  <div>
                    <p class="text-sm font-['Noto_Sans_TC',_sans-serif] text-white leading-relaxed">
                      走廊區域適合小型展示和作品陳列，人流量大。
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- 前陽台 -->
            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion('front-balcony')">
                <h2 class="text-xl font-['Noto_Sans_TC',_sans-serif] text-white font-medium">前陽台</h2>
                <svg class="expand-icon plus" id="icon-front-balcony" viewBox="0 0 24 24">
                  <line x1="4" y1="12" x2="20" y2="12" stroke="white" stroke-width="1"/>
                  <line x1="12" y1="4" x2="12" y2="20" stroke="white" stroke-width="1"/>
                </svg>
              </div>
              <div class="accordion-content" id="content-front-balcony">
                <div class="accordion-content-inner space-y-4">
                  <div class="space-y-2">
                    <div class="text-sm font-['Inter',_sans-serif] font-normal tracking-wide text-zinc-300">押金/塊</div>
                    <div class="text-3xl font-['Inter',_sans-serif] font-normal text-white tracking-wide">NT1,000</div>
                  </div>
                  <div>
                    <p class="text-sm font-['Noto_Sans_TC',_sans-serif] text-white leading-relaxed">
                      前陽台擁有絕佳視野，適合戶外展示和活動。
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- 後陽台 -->
            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion('back-balcony')">
                <h2 class="text-xl font-['Noto_Sans_TC',_sans-serif] text-white font-medium">後陽台</h2>
                <svg class="expand-icon plus" id="icon-back-balcony" viewBox="0 0 24 24">
                  <line x1="4" y1="12" x2="20" y2="12" stroke="white" stroke-width="1"/>
                  <line x1="12" y1="4" x2="12" y2="20" stroke="white" stroke-width="1"/>
                </svg>
              </div>
              <div class="accordion-content" id="content-back-balcony">
                <div class="accordion-content-inner space-y-4">
                  <div class="space-y-2">
                    <div class="text-sm font-['Inter',_sans-serif] font-normal tracking-wide text-zinc-300">押金/塊</div>
                    <div class="text-3xl font-['Inter',_sans-serif] font-normal text-white tracking-wide">NT2,000</div>
                  </div>
                  <div>
                    <p class="text-sm font-['Noto_Sans_TC',_sans-serif] text-white leading-relaxed">
                      後陽台環境相對安靜，適合需要專注的創作活動。
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- 玻璃牆 -->
            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion('glass-wall')">
                <h2 class="text-xl font-['Noto_Sans_TC',_sans-serif] text-white font-medium">玻璃牆</h2>
                <svg class="expand-icon plus" id="icon-glass-wall" viewBox="0 0 24 24">
                  <line x1="4" y1="12" x2="20" y2="12" stroke="white" stroke-width="1"/>
                  <line x1="12" y1="4" x2="12" y2="20" stroke="white" stroke-width="1"/>
                </svg>
              </div>
              <div class="accordion-content" id="content-glass-wall">
                <div class="accordion-content-inner space-y-4">
                  <div class="space-y-2">
                    <div class="text-sm font-['Inter',_sans-serif] font-normal tracking-wide text-zinc-300">押金/塊</div>
                    <div class="text-3xl font-['Inter',_sans-serif] font-normal text-white tracking-wide">NT1,000</div>
                  </div>
                  <div>
                    <p class="text-sm font-['Noto_Sans_TC',_sans-serif] text-white leading-relaxed">
                      玻璃牆區域展示效果佳，適合視覺作品展出。
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- 柱子 -->
            <div class="accordion-item">
              <div class="accordion-header" onclick="toggleAccordion('pillar')">
                <h2 class="text-xl font-['Noto_Sans_TC',_sans-serif] text-white font-medium">柱子</h2>
                <svg class="expand-icon plus" id="icon-pillar" viewBox="0 0 24 24">
                  <line x1="4" y1="12" x2="20" y2="12" stroke="white" stroke-width="1"/>
                  <line x1="12" y1="4" x2="12" y2="20" stroke="white" stroke-width="1"/>
                </svg>
              </div>
              <div class="accordion-content" id="content-pillar">
                <div class="accordion-content-inner space-y-4">
                  <div class="space-y-2">
                    <div class="text-sm font-['Inter',_sans-serif] font-normal tracking-wide text-zinc-300">押金/塊</div>
                    <div class="text-3xl font-['Inter',_sans-serif] font-normal text-white tracking-wide">NT1,000</div>
                  </div>
                  <div>
                    <p class="text-sm font-['Noto_Sans_TC',_sans-serif] text-white leading-relaxed">
                      柱子區域適合立體作品展示和裝置藝術。
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 中間：地圖區域 -->
          <!-- 📍 SPACING CONTROL: 這裡是第二部分右移距離控制 - 調整 ml-4 的數值 -->
          <div class="flex-3 overflow-hidden ml-4"> <!-- 增加中間部分的比例 -->
            <div class="map-container" id="map-container">
              <!-- SVG將由JavaScript動態載入 -->
            </div>
          </div>

          <!-- 右側：資訊和按鈕 -->
          <!-- 📍 SPACING CONTROL: 這裡是第三部分右移距離控制 - 調整 ml-12 的數值 -->
          <div class="w-1/5 flex flex-col ml-8"> <!-- 減少右側寬度和間距 -->
            <!-- 狀態指示器 -->
            <div class="status-indicators">
              <div class="status-item">
                <div class="status-box status-available"></div>
                <span class="text-base font-['Noto_Sans_TC',_sans-serif] text-white">可租借</span>
              </div>
              <div class="status-item">
                <div class="status-box status-booked"></div>
                <span class="text-base font-['Noto_Sans_TC',_sans-serif] text-white">已借出</span>
              </div>
              <div class="status-item">
                <div class="status-box status-selected"></div>
                <span class="text-base font-['Noto_Sans_TC',_sans-serif] text-white">已選擇</span>
              </div>
            </div>

            <div class="flex-grow"></div>

            <!-- 租借資訊 -->
            <div class="space-y-6 mb-12"> <!-- 增加底部間距讓按鈕更靠近footer -->
              <!-- 租借區塊 -->
              <div>
                <div class="text-base font-['Inter',_sans-serif] font-normal tracking-wide text-zinc-300 mb-2">租借區塊</div>
                <div id="selected-blocks" class="text-2xl font-['Inter',_sans-serif] font-normal text-white tracking-wide">--</div>
              </div>

              <!-- 押金總額 -->
              <div>
                <div class="text-base font-['Inter',_sans-serif] font-normal tracking-wide text-zinc-300 mb-2">押金總額</div>
                <div id="total-deposit" class="text-2xl font-['Inter',_sans-serif] font-normal text-white tracking-wide">NT0</div>
              </div>
            </div>

            <!-- 按鈕區域 -->
            <div class="flex gap-4"> <!-- 使用flex布局和gap -->
              <button id="clear-btn" class="border border-white bg-transparent text-white opacity-30 font-['Inter',_sans-serif] font-normal py-3 px-6 text-lg cursor-not-allowed button-animated flex-1" style="position: relative; overflow: hidden;" disabled onclick="clearSelection()">
                <div class="button-bg-fill" style="position: absolute; bottom: 0; left: 0; width: 100%; height: 0; background-color: white; z-index: 1;"></div>
                <span style="position: relative; z-index: 2;">清除</span>
              </button>
              <button id="add-area-btn" class="bg-white text-black opacity-30 font-['Inter',_sans-serif] font-normal py-3 px-6 transition-all text-lg cursor-not-allowed hover:opacity-60 flex-1" disabled onclick="addAreaToCart()">
                加入清單
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 手機版佈局 -->
      <div class="w-full md:hidden flex-grow flex flex-col">
        <!-- 標題區域 -->
        <div class="mobile-title-section">
          <h1 class="text-3xl font-['Noto_Sans_TC',_sans-serif] font-medium mb-4">
            A5F編號區
          </h1>
        </div>
        
        <!-- 暫時內容 -->
        <div class="flex-grow flex items-center justify-center">
          <p class="text-base font-['Noto_Sans_TC',_sans-serif] font-normal text-white">製作中，敬請期待！</p>
        </div>
      </div>
    </main>

    <!-- Tooltip 元件 -->
    <div id="grid-tooltip"></div>

    <!-- 通知元件 -->
    <div id="notification">
      <p id="notification-text" class="text-base font-['Noto_Sans_TC',_sans-serif] leading-relaxed text-center"></p>
    </div>

            <footer class="pt-4 pb-8">
      <div class="container mx-auto px-6 md:px-4 flex flex-col md:flex-row justify-between items-center text-sm">
        <div class="flex space-x-6 md:mb-0 hidden md:flex">
          <a
            href="https://sccd.usc.edu.tw/"
            target="_blank"
            class="font-['Inter',_sans-serif] transition-colors arrow-link footer-link"
            >TO SCCD
            <div class="arrow-container">
              <div class="arrow-icons-wrapper">
                <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
                <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
              </div>
            </div>
          </a>
          <a
            href="about.html"
            class="font-['Inter',_sans-serif] transition-colors arrow-link footer-link"
            >ABOUT
            <div class="arrow-container">
              <div class="arrow-icons-wrapper">
                <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
                <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
              </div>
            </div>
          </a>
        </div>
        <div class="copyright text-xs md:text-right">
          <p>
            <span class="copyright-original">
              <span class="font-['Inter',_sans-serif] uppercase">Copyright © 2025 111</span>屆系學會
              <span class="font-['Inter',_sans-serif] uppercase">All rights reserved.</span>
            </span>
            <span class="copyright-easter-egg" id="easter-egg-text">
              <!-- 彩蛋文字將由JavaScript生成 -->
            </span>
          </p>
        </div>
      </div>
    </footer>

    <!-- 手機版選單 -->
    <div class="mobile-menu md:hidden" id="mobile-menu">
      <!-- Header區域 -->
      <div class="py-6 px-6">
        <div class="flex justify-between items-center">
          <a href="index.html" class="logo-link">
            <div class="font-['Inter',_sans-serif] logo text-base font-medium text-white">
              SCCD
            </div>
          </a>
          <button class="font-['Inter',_sans-serif] text-base" id="mobile-menu-close">
            <span class="text-white">CLOSE</span>
          </button>
        </div>
      </div>
      
      <!-- 選單項目 -->
      <div class="flex-grow px-6">
        <nav>
          <ul class="flex flex-col space-y-4">
            <li class="menu-animate-enter">
              <a
                href="booking.html"
                class="font-['Inter',_sans-serif] text-base font-medium transition-colors nav-link block text-white menu-animate-enter-content menu-delay-1"
                >BOOKING</a
              >
            </li>
            <li class="menu-animate-enter">
              <a
                href="resources.html"
                class="font-['Inter',_sans-serif] text-base font-medium transition-colors nav-link block text-white menu-animate-enter-content menu-delay-2"
                >RESOURCES</a
              >
            </li>
            <li class="menu-animate-enter">
              <a
                href="login.html"
                class="font-['Inter',_sans-serif] text-base font-medium transition-colors nav-link block text-white menu-animate-enter-content menu-delay-3"
                >LOG IN</a
              >
            </li>
          </ul>
        </nav>
      </div>
      
      <!-- Footer區域 -->
      <div class="pt-4 pb-8 px-6">
        <div class="flex flex-col text-sm">
          <div class="flex flex-col space-y-2 mb-2 items-start">
            <div class="menu-animate-enter">
              <a
                href="https://sccd.usc.edu.tw/"
                target="_blank"
                class="font-['Inter',_sans-serif] transition-colors arrow-link footer-link menu-animate-enter-content menu-delay-4"
                >TO SCCD
                <div class="arrow-container">
                  <div class="arrow-icons-wrapper">
                    <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
                    <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
                  </div>
                </div>
              </a>
            </div>
            <div class="menu-animate-enter">
              <a
                href="about.html"
                class="font-['Inter',_sans-serif] transition-colors arrow-link footer-link menu-animate-enter-content menu-delay-5"
                >ABOUT
                <div class="arrow-container">
                  <div class="arrow-icons-wrapper">
                    <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
                    <img src="Icons/Small Arrow UpRight.svg" alt="Arrow" class="arrow-icon">
                  </div>
                </div>
              </a>
            </div>
          </div>
          <div class="menu-animate-enter">
            <div class="copyright text-xs menu-animate-enter-content menu-delay-6">
              <p>
                <span class="copyright-original">
                  <span class="font-['Inter',_sans-serif] uppercase">Copyright © 2025 111</span>屆系學會
                  <span class="font-['Inter',_sans-serif] uppercase">All rights reserved.</span>
                </span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let currentSelectedArea = 'courtyard';
      let selectedBlocks = []; // 存儲選中的區塊
      let selectedBlockNames = []; // 存儲選中區塊的名稱
      
      // 存儲每個區域的選擇狀態
      let areaSelections = {
        'courtyard': [],
        'corridor': [],
        'front-balcony': [],
        'back-balcony': [],
        'glass-wall': [],
        'pillar': []
      };
      
      // 存儲已加入購物車的區塊（按區域分類）
      let cartBlocks = {
        'courtyard': [],
        'corridor': [],
        'front-balcony': [],
        'back-balcony': [],
        'glass-wall': [],
        'pillar': []
      };
      
      // 區域資料
      const areaData = {
        'courtyard': {
          id: 'area-courtyard',
          name: '中庭',
          category: 'area',
          deposit: 1000,
          image: 'Area/A5F Numbered Area_Square.svg',
          mapImage: 'Area/A5F Numbered Area_Square.svg'
        },
        'corridor': {
          id: 'area-corridor',
          name: '走廊',
          category: 'area',
          deposit: 1000,
          image: 'Area/A5F Numbered Area_Square.svg',
          mapImage: 'Area/A5F Numbered Area_Square.svg'
        },
        'front-balcony': {
          id: 'area-front-balcony',
          name: '前陽台',
          category: 'area',
          deposit: 1000,
          image: 'Area/A5F Numbered Area_Square.svg',
          mapImage: 'Area/A5F Numbered Area_Square.svg'
        },
        'back-balcony': {
          id: 'area-back-balcony',
          name: '後陽台',
          category: 'area',
          deposit: 2000,
          image: 'Area/A5F Numbered Area_Square.svg',
          mapImage: 'Area/A5F Numbered Area_Square.svg'
        },
        'glass-wall': {
          id: 'area-glass-wall',
          name: '玻璃牆',
          category: 'area',
          deposit: 1000,
          image: 'Area/A5F Numbered Area_Square.svg',
          mapImage: 'Area/A5F Numbered Area_Square.svg'
        },
        'pillar': {
          id: 'area-pillar',
          name: '柱子',
          category: 'area',
          deposit: 1000,
          image: 'Area/A5F Numbered Area_Square.svg',
          mapImage: 'Area/A5F Numbered Area_Square.svg'
        }
      };
      
      function toggleAccordion(areaId) {
        // 如果點擊的是已經打開的區域，就關閉它
        if (currentSelectedArea === areaId) {
          closeAccordion(areaId);
          currentSelectedArea = null;
          updateAreaDisplay();
          return;
        }
        
        // 關閉當前打開的區域
        if (currentSelectedArea) {
          closeAccordion(currentSelectedArea);
        }
        
        // 延遲打開新選擇的區域
        setTimeout(() => {
          // 保存當前區域的選擇狀態（排除已在購物車中的格子）
          if (currentSelectedArea) {
            const currentCartBlocks = cartBlocks[currentSelectedArea] || [];
            const availableSelections = selectedBlockNames.filter(blockName => 
              !currentCartBlocks.includes(blockName)
            );
            areaSelections[currentSelectedArea] = [...availableSelections];
          }
          
          openAccordion(areaId);
          currentSelectedArea = areaId;
          updateAreaDisplay();
          
          // 先恢復購物車中格子的視覺狀態
          setTimeout(() => {
            restoreCartBlocksVisualState();
            
            // 然後恢復新區域的選擇狀態（排除已在購物車中的格子）
            const cartBlocksInNewArea = cartBlocks[areaId] || [];
            const availableSelections = areaSelections[areaId].filter(blockName => 
              !cartBlocksInNewArea.includes(blockName)
            );
            selectedBlockNames = [...availableSelections];
            selectedBlocks = [...selectedBlockNames]; // 保持同步
            updateSelectedBlocks();
          }, 50);
        }, 200);
      }
      
      function openAccordion(areaId) {
        const content = document.getElementById(`content-${areaId}`);
        const contentInner = content.querySelector('.accordion-content-inner');
        const icon = document.getElementById(`icon-${areaId}`);
        
        // 先設置內容顯示以計算高度
        gsap.set(contentInner, { opacity: 0 });
        content.classList.add('expanded'); // 添加expanded類別以獲得正確的padding
        gsap.set(content, { height: 'auto' });
        const autoHeight = content.offsetHeight;
        gsap.set(content, { height: 0 });
        
        // 使用GSAP動畫展開
        const tl = gsap.timeline();
        tl.to(content, {
          height: autoHeight,
          duration: 0.5,
          ease: "power2.out",
          onComplete: () => {
            gsap.set(content, { height: 'auto' }); // 設置為auto以適應內容變化
          }
        })
        .to(contentInner, {
          opacity: 1,
          duration: 0.3,
          ease: "power2.out"
        }, "-=0.2");
        
        // 改變圖標為 "-"
        icon.innerHTML = '<line x1="4" y1="12" x2="20" y2="12" stroke="white" stroke-width="1"/>';
        icon.classList.remove('plus');
      }
      
      function closeAccordion(areaId) {
        const content = document.getElementById(`content-${areaId}`);
        const contentInner = content.querySelector('.accordion-content-inner');
        const icon = document.getElementById(`icon-${areaId}`);
        
        // 使用GSAP動畫收起
        const tl = gsap.timeline();
        tl.to(contentInner, {
          opacity: 0,
          duration: 0.2,
          ease: "power2.out"
        })
        .to(content, {
          height: 0,
          duration: 0.4,
          ease: "power2.out",
          onComplete: () => {
            content.classList.remove('expanded'); // 動畫完成後移除expanded類別
          }
        }, "-=0.1");
        
        // 改變圖標為 "+"
        icon.innerHTML = '<line x1="4" y1="12" x2="20" y2="12" stroke="white" stroke-width="1"/><line x1="12" y1="4" x2="12" y2="20" stroke="white" stroke-width="1"/>';
        icon.classList.add('plus');
      }
      
      function updateAreaDisplay() {
        if (!currentSelectedArea) {
          return;
        }
        
        const mapContainer = document.getElementById('map-container');
        const svgData = getSVGDataForArea(currentSelectedArea);
        
        // 為玻璃牆和柱子設置滾動容器
        if (currentSelectedArea === 'glass-wall' || currentSelectedArea === 'pillar') {
          mapContainer.classList.add('scrollable');
        } else {
          mapContainer.classList.remove('scrollable');
        }
        
        // 動態更新SVG內容
        mapContainer.innerHTML = svgData.svg;
        
        // 為玻璃牆和柱子的SVG添加no-scale class
        const svg = mapContainer.querySelector('#area-map');
        if (svg && (currentSelectedArea === 'glass-wall' || currentSelectedArea === 'pillar')) {
          svg.classList.add('no-scale');
        }
        
        // 確保SVG完全載入後再設置點擊事件和狀態
        requestAnimationFrame(() => {
          setTimeout(() => {
            console.log(`開始設置區域 ${currentSelectedArea} 的格子狀態`);
            setupSVGClickEvents();
            
            // 設置已提交訂單的格子為已預訂狀態（紅色）
            submittedBlocks[currentSelectedArea].forEach(blockName => {
              const cell = document.getElementById(blockName);
              if (cell) {
                cell.classList.add('booked');
                console.log(`格子 ${blockName} 設為已提交狀態 (紅色)`);
              }
            });
            
            // 示範：設置一些格子為已預訂狀態（可選，用於測試）
            const demoBookedBlocks = getBookedBlocksForArea(currentSelectedArea);
            demoBookedBlocks.forEach(blockName => {
              const cell = document.getElementById(blockName);
              if (cell) {
                cell.classList.add('booked');
                console.log(`格子 ${blockName} 設為示範預訂狀態 (紅色)`);
              }
            });
            
            // 恢復已選擇的區塊視覺狀態
            selectedBlockNames.forEach(blockName => {
              const cell = document.getElementById(blockName);
              if (cell && !cell.classList.contains('booked')) {
                cell.classList.add('selected');
                console.log(`格子 ${blockName} 恢復選中狀態 (綠色)`);
              }
            });
            
            // 恢復已加入購物車的區塊視覺狀態（綠色）
            console.log('準備恢復購物車格子視覺狀態...');
            restoreCartBlocksVisualState();
            console.log(`區域 ${currentSelectedArea} 格子狀態設置完成`);
          }, 50);
        });
      }
      
      function getSVGDataForArea(areaId) {
        const svgConfigs = {
          'courtyard': {
            svg: `<svg id="area-map" class="map-svg" viewBox="0 0 499.93 836.04" xmlns="http://www.w3.org/2000/svg">
              <g id="Square">
                <rect class="grid-cell" id="A10" x="38.12" y="87.5" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="A11" x="38.12" y="31.52" width="55" height="40" style="fill: #898989;"/>
                <rect class="grid-cell" id="B11" x="109.48" y="31.52" width="55" height="40" style="fill: #898989;"/>
                <rect class="grid-cell" id="C11" x="180.83" y="31.52" width="55" height="40" style="fill: #898989;"/>
                <rect class="grid-cell" id="D11" x="252.18" y="31.52" width="55" height="40" style="fill: #898989;"/>
                <rect class="grid-cell" id="E11" x="323.53" y="31.52" width="55" height="40" style="fill: #898989;"/>
                <rect class="grid-cell" id="F6" x="445.07" y="31.43" width="25" height="96.03" style="fill: #898989;"/>
                <rect class="grid-cell" id="F5" x="445.07" y="173.14" width="25" height="96.03" style="fill: #898989;"/>
                <rect class="grid-cell" id="F4" x="445.07" y="314.86" width="25" height="96.03" style="fill: #898989;"/>
                <rect class="grid-cell" id="F3" x="445.07" y="456.57" width="25" height="96.03" style="fill: #898989;"/>
                <rect class="grid-cell" id="F2" x="445.07" y="598.29" width="25" height="96.03" style="fill: #898989;"/>
                <rect class="grid-cell" id="F1" x="445.07" y="740" width="25" height="96.03" style="fill: #898989;"/>
                <rect class="grid-cell" id="B10" x="109.48" y="87.5" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="C10" x="180.83" y="87.5" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="D10" x="252.18" y="87.5" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E10" x="323.53" y="87.5" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="A9" x="38.12" y="158.53" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="A8" x="38.12" y="229.57" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="A7" x="38.12" y="300.61" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B9" x="109.48" y="158.53" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="C9" x="180.83" y="158.53" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="D9" x="252.18" y="158.53" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E9" x="323.53" y="158.53" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B8" x="109.48" y="229.57" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="C8" x="180.83" y="229.57" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="D8" x="252.18" y="229.57" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E8" x="323.53" y="229.57" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B7" x="109.48" y="300.61" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="C7" x="180.83" y="300.61" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="D7" x="252.18" y="300.61" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E7" x="323.53" y="300.61" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B6" x="109.48" y="371.65" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="C6" x="180.83" y="371.65" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="D6" x="252.18" y="371.65" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E6" x="323.53" y="371.65" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B5" x="109.48" y="442.68" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="C5" x="180.83" y="442.68" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="D5" x="252.18" y="442.68" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E5" x="323.53" y="442.68" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B4" x="109.48" y="513.72" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="C4" x="180.83" y="513.72" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="D4" x="252.18" y="513.72" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E4" x="323.53" y="513.72" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B3" x="109.48" y="584.76" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B2" x="109.48" y="655.8" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="B1" x="109.48" y="726.83" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="A4" x="38.12" y="513.72" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="A3" x="38.12" y="584.76" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="A2" x="38.12" y="655.8" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="A1" x="38.12" y="726.83" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="C3" x="180.83" y="584.76" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="D3" x="252.18" y="584.76" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E3" x="323.53" y="584.76" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E2" x="323.53" y="655.8" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="E1" x="323.53" y="726.83" width="55" height="55" style="fill: #898989;"/>
                <polygon class="grid-cell" id="A6" points="38.13 371.65 38.13 414.29 50.48 414.29 50.48 426.65 93.13 426.65 93.13 371.65 38.13 371.65" style="fill: #898989;"/>
                <polygon class="grid-cell" id="A5" points="50.48 442.68 50.48 455.04 38.13 455.04 38.13 497.68 93.13 497.68 93.13 442.68 50.48 442.68" style="fill: #898989;"/>
                
                <text transform="translate(59.54 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">A</tspan></text>
                <text transform="translate(1.45 56.42)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">11</tspan></text>
                <text transform="translate(0 119.89)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">10</tspan></text>
                <text transform="translate(4.19 190.93)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">9</tspan></text>
                <text transform="translate(4.26 261.97)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">8</tspan></text>
                <text transform="translate(4.67 333.01)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">7</tspan></text>
                <text transform="translate(4.19 404.04)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">6</tspan></text>
                <text transform="translate(4.34 475.08)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">5</tspan></text>
                <text transform="translate(4.03 546.12)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">4</tspan></text>
                <text transform="translate(4.08 617.16)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">3</tspan></text>
                <text transform="translate(4.36 688.19)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">2</tspan></text>
                <text transform="translate(5.63 759.23)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">1</tspan></text>
                <text transform="translate(488.53 84.34)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">6</tspan></text>
                <text transform="translate(488.67 226.06)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">5</tspan></text>
                <text transform="translate(488.37 367.77)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">4</tspan></text>
                <text transform="translate(488.42 509.49)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">3</tspan></text>
                <text transform="translate(488.7 651.2)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">2</tspan></text>
                <text transform="translate(489.97 792.92)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">1</tspan></text>
                <text transform="translate(131.12 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">B</tspan></text>
                <text transform="translate(201.78 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">C</tspan></text>
                <text transform="translate(273.2 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">D</tspan></text>
                <text transform="translate(345.64 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">E</tspan></text>
                <text transform="translate(452.29 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">F</tspan></text>
              </g>
            </svg>`
          },
          'corridor': {
            svg: `<svg id="area-map" class="map-svg" viewBox="0 0 459.1 855.74" xmlns="http://www.w3.org/2000/svg">
              <g id="Corridor">
                <text transform="translate(58.41 15.54)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">G</tspan></text>
                <text transform="translate(129.79 15.54)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">H</tspan></text>
                <rect class="grid-cell" id="G10" x="37.6" y="32.88" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="G9" x="37.6" y="106.11" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="G8" x="37.6" y="179.35" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="G7" x="37.6" y="252.58" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="G6" x="37.6" y="325.81" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="G5" x="37.6" y="399.04" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="H9" x="112.1" y="106.11" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="H8" x="112.1" y="179.35" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="H7" x="112.1" y="252.58" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="H6" x="112.1" y="325.81" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="H3" x="112.1" y="545.51" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="H2" x="112.1" y="618.74" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="H1" x="112.1" y="691.97" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="J3" x="404.1" y="766.4" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="J2" x="330.87" y="766.4" width="55" height="55" style="fill: #898989;"/>
                <rect class="grid-cell" id="J1" x="257.64" y="766.4" width="55" height="55" style="fill: #898989;"/>
                <polygon class="grid-cell" id="H5" points="167.1 399.14 167.1 441.78 154.74 441.78 154.74 454.14 112.1 454.14 112.1 399.14 167.1 399.14" style="fill: #898989;"/>
                <polygon class="grid-cell" id="H4" points="154.74 472.27 154.74 484.63 167.1 484.63 167.1 527.27 112.1 527.27 112.1 472.27 154.74 472.27" style="fill: #898989;"/>
                <polygon class="grid-cell" id="H10" points="154.74 32.88 154.74 45.24 167.1 45.24 167.1 87.88 112.1 87.88 112.1 32.88 154.74 32.88" style="fill: #898989;"/>
                <text transform="translate(0 65.28)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">10</tspan></text>
                <text transform="translate(4.19 138.51)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">9</tspan></text>
                <text transform="translate(4.26 211.74)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">8</tspan></text>
                <text transform="translate(4.67 284.98)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">7</tspan></text>
                <text transform="translate(4.19 358.21)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">6</tspan></text>
                <text transform="translate(4.33 431.44)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">5</tspan></text>
                <text transform="translate(4.03 504.67)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">4</tspan></text>
                <text transform="translate(4.08 577.9)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">3</tspan></text>
                <text transform="translate(4.36 651.14)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">2</tspan></text>
                <text transform="translate(5.62 724.37)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">1</tspan></text>
                <text transform="translate(276.07 849.99)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">J1</tspan></text>
                <text transform="translate(348.04 849.99)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">J2</tspan></text>
                <text transform="translate(420.99 849.99)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">J3</tspan></text>
              </g>
            </svg>`
          },
          'front-balcony': {
            svg: `<svg id="area-map" class="map-svg" viewBox="0 0 511.81 762.8" xmlns="http://www.w3.org/2000/svg">
              <g id="Front_Terrace">
                <rect class="grid-cell" id="K3" x="0" y="30.34" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K2" x="0" y="187.3" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K1" x="0" y="344.25" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K6" x="135.72" y="187.3" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K5" x="135.72" y="344.25" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K4" x="135.72" y="501.2" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K9" x="271.44" y="344.25" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K8" x="271.44" y="501.2" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K10" x="407.17" y="501.2" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="K7" x="271.44" y="658.15" width="104.65" height="104.65" style="fill: #898989;"/>
                
                <text transform="translate(40.73 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K3</tspan></text>
                <text transform="translate(41.3 172.23)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K2</tspan></text>
                <text transform="translate(176.57 172.23)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K6</tspan></text>
                <text transform="translate(42.57 329.51)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K1</tspan></text>
                <text transform="translate(176.71 329.51)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K5</tspan></text>
                <text transform="translate(312.29 329.51)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K9</tspan></text>
                <text transform="translate(176.55 487.57)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K4</tspan></text>
                <text transform="translate(312.28 487.57)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K8</tspan></text>
                <text transform="translate(312.69 646.9)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K7</tspan></text>
                <text transform="translate(443.67 487.57)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">K10</tspan></text>
              </g>
            </svg>`
          },
          'back-balcony': {
            svg: `<svg id="area-map" class="map-svg" data-area="back-balcony" viewBox="0 0 210.95 452.03" xmlns="http://www.w3.org/2000/svg">
              <g id="Back_Terrace">
                <rect class="grid-cell" id="L3" x="0" y="33.48" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="L2" x="0" y="190.43" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="L1" x="0" y="347.38" width="104.65" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="L6" x="127.64" y="33.48" width="83.31" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="L5" x="127.64" y="190.43" width="83.31" height="104.65" style="fill: #898989;"/>
                <rect class="grid-cell" id="L4" x="127.64" y="347.38" width="83.31" height="104.65" style="fill: #898989;"/>
                
                <text transform="translate(41.53 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">L3</tspan></text>
                <text transform="translate(158.62 15.55)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">L6</tspan></text>
                <text transform="translate(41.82 173.57)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">L2</tspan></text>
                <text transform="translate(158.76 173.57)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">L5</tspan></text>
                <text transform="translate(43.49 330.66)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0" style="letter-spacing: -.05em;">L</tspan><tspan x="9.31" y="0" style="letter-spacing: 0em;">1</tspan></text>
                <text transform="translate(158.45 330.66)" style="fill: #fff; font-family: Inter-Regular, Inter; font-size: 18px;"><tspan x="0" y="0">L4</tspan></text>
              </g>
            </svg>`
          },
          'glass-wall': {
            svg: `<div class="flex items-center justify-center h-full">
              <p class="text-base font-['Noto_Sans_TC',_sans-serif] font-normal text-white">製作中，敬請期待！</p>
            </div>`
          },
          'pillar': {
            svg: `<div class="flex items-center justify-center h-full">
              <p class="text-base font-['Noto_Sans_TC',_sans-serif] font-normal text-white">製作中，敬請期待！</p>
            </div>`
          }
        };
        
        return svgConfigs[areaId] || svgConfigs['courtyard'];
      }
      
      function getBookedBlocksForArea(areaId) {
        // 為不同區域設置不同的預訂狀態示範
        const bookedBlocks = {
          'courtyard': ['B5', 'C7', 'D9'],
          'corridor': ['G8', 'H6'],
          'front-balcony': ['K3', 'K7'],
          'back-balcony': ['L2'],
          'glass-wall': ['Y5', 'Y12', 'Y20'],
          'pillar': ['Z3', 'Z6']
        };
        
        return bookedBlocks[areaId] || [];
      }
      
      function setupSVGClickEvents() {
        // 為每個格子添加點擊事件
        const gridCells = document.querySelectorAll('.grid-cell');
        const tooltip = document.getElementById('grid-tooltip');
        
        // 如果沒有找到格子元素，延遲重試
        if (gridCells.length === 0) {
          setTimeout(() => {
            setupSVGClickEvents();
          }, 50);
          return;
        }
        
        gridCells.forEach(cell => {
          // 點擊事件
          cell.addEventListener('click', function() {
            const blockName = this.id;
            handleBlockClick(blockName);
          });
          
          // Hover事件 - 顯示tooltip
          cell.addEventListener('mouseenter', function(e) {
            const blockName = this.id;
            tooltip.textContent = blockName;
            tooltip.classList.add('show');
            updateTooltipPosition(e);
          });
          
          // 滑鼠移動事件 - 更新tooltip位置
          cell.addEventListener('mousemove', function(e) {
            updateTooltipPosition(e);
          });
          
          // 離開hover - 隱藏tooltip
          cell.addEventListener('mouseleave', function() {
            tooltip.classList.remove('show');
          });
        });
      }
      
      function updateTooltipPosition(e) {
        const tooltip = document.getElementById('grid-tooltip');
        tooltip.style.left = e.clientX + 'px';
        tooltip.style.top = e.clientY + 'px';
      }
      
      function handleBlockClick(blockName) {
        const cell = document.getElementById(blockName);
        
        // 調試用：輸出當前狀態（可在生產環境中移除）
        // console.log('點擊格子:', blockName);
        
        // 檢查是否已被預訂（這裡可以設置一些預訂的格子用於示範）
        if (cell.classList.contains('booked')) {
          showNotification(`${blockName} 已被預訂！`, 'error');
          return;
        }
        
        // 使用購物車管理器檢查是否已在購物車中
        if (window.cartManager && window.cartManager.isBlockInCart(currentSelectedArea, blockName)) {
          showNotification(`${blockName} 已在租借清單中！`, 'error');
          return;
        }
        
        // 檢查本地購物車記錄（雙重保險）
        if (cartBlocks[currentSelectedArea] && cartBlocks[currentSelectedArea].includes(blockName)) {
          showNotification(`${blockName} 已在租借清單中！`, 'error');
          return;
        }
        
        // 檢查是否已提交訂單
        if (submittedBlocks[currentSelectedArea] && submittedBlocks[currentSelectedArea].includes(blockName)) {
          showNotification(`${blockName} 已提交訂單！`, 'error');
          return;
        }
        
        const index = selectedBlockNames.indexOf(blockName);
        if (index > -1) {
          // 如果已選中，則取消選中
          selectedBlockNames.splice(index, 1);
          cell.classList.remove('selected');
          // console.log('取消選中:', blockName);
        } else {
          // 如果未選中，則添加到選中列表
          selectedBlockNames.push(blockName);
          cell.classList.add('selected');
          // console.log('新增選中:', blockName);
        }
        
        updateSelectedBlocks();
      }
      
      function updateSelectedBlocks() {
        const selectedBlocksElement = document.getElementById('selected-blocks');
        const totalDepositElement = document.getElementById('total-deposit');
        const addButton = document.getElementById('add-area-btn');
        const clearButton = document.getElementById('clear-btn');
        
        if (selectedBlockNames.length === 0) {
          selectedBlocksElement.textContent = '--';
          totalDepositElement.textContent = 'NT0';
          
          // 兩個按鈕都禁用
          addButton.disabled = true;
          addButton.classList.add('opacity-30', 'cursor-not-allowed');
          addButton.classList.remove('opacity-100', 'cursor-pointer');
          
          clearButton.disabled = true;
          clearButton.classList.add('opacity-30', 'cursor-not-allowed');
          clearButton.classList.remove('opacity-100', 'cursor-pointer');
        } else {
          selectedBlocksElement.textContent = selectedBlockNames.join(', ');
          
          // 根據當前區域計算押金
          const area = areaData[currentSelectedArea];
          const totalDeposit = selectedBlockNames.length * (area ? area.deposit : 1000);
          totalDepositElement.textContent = `NT${totalDeposit.toLocaleString()}`;
          
          // 兩個按鈕都啟用
          addButton.disabled = false;
          addButton.classList.remove('opacity-30', 'cursor-not-allowed');
          addButton.classList.add('opacity-100', 'cursor-pointer');
          
          clearButton.disabled = false;
          clearButton.classList.remove('opacity-30', 'cursor-not-allowed');
          clearButton.classList.add('opacity-100', 'cursor-pointer');
        }
      }
      
      function clearSelection() {
        const clearButton = document.getElementById('clear-btn');
        
        if (clearButton.disabled) {
          return;
        }
        
        // 清除所有選中的格子（但不影響已在購物車中的格子）
        selectedBlockNames.forEach(blockName => {
          const cell = document.getElementById(blockName);
          if (cell && !cartBlocks[currentSelectedArea].includes(blockName)) {
            cell.classList.remove('selected');
          }
        });
        
        // 清空選中列表
        selectedBlockNames = [];
        selectedBlocks = [];
        
        // 清空當前區域的記錄
        if (currentSelectedArea) {
          areaSelections[currentSelectedArea] = [];
        }
        
        // 更新顯示
        updateSelectedBlocks();
        
        // 顯示通知
        showNotification('已清除所有選擇！');
        
        // 執行點擊後的反向動畫
        const buttonFill = clearButton.querySelector('.button-bg-fill');
        if (buttonFill) {
          // 先快速填滿背景
          gsap.set(buttonFill, { height: '100%' });
          clearButton.classList.add('white-text');
          
          // 然後執行從上往下的清空動畫，同時文字顏色逐漸變回白色
          setTimeout(() => {
            gsap.to(buttonFill, {
              height: '0%',
              duration: 0.5,
              ease: "power2.out"
            });
            
            // 文字顏色同時開始過渡變回白色
            clearButton.classList.remove('white-text');
          }, 100);
        }
      }
      
      function addAreaToCart() {
        const button = document.getElementById('add-area-btn');
        
        if (button.disabled || !currentSelectedArea || selectedBlockNames.length === 0) {
          showNotification('請先選擇區塊！', 'error');
          return;
        }
        
        // 使用購物車管理器檢查重複格子
        if (window.cartManager) {
          const duplicateBlocks = selectedBlockNames.filter(blockName => 
            window.cartManager.isBlockInCart(currentSelectedArea, blockName)
          );
          
          if (duplicateBlocks.length > 0) {
            showNotification(`以下格子已在租借清單中：${duplicateBlocks.join(', ')}`, 'error');
            return;
          }
        }
        
        const area = areaData[currentSelectedArea];
        const totalDeposit = selectedBlockNames.length * area.deposit;
        const blockList = selectedBlockNames.join(', ');
        
        // 創建購物車項目
        const cartItem = {
          id: `${area.id}-${Date.now()}`, // 使用時間戳確保唯一性
          name: `${area.name} (${blockList})`,
          category: area.category,
          deposit: totalDeposit,
          mainImage: area.image,
          blocks: selectedBlockNames.slice(), // 複製數組
          areaKey: currentSelectedArea // 添加區域鍵值以便後續識別
        };
        
        const success = window.cartManager.addToCart(cartItem);
        
        if (success) {
          showNotification(`${area.name}區域 ${blockList} 已成功加入租借清單！`);
          
          // 將選中的區塊加入購物車記錄
          cartBlocks[currentSelectedArea] = cartBlocks[currentSelectedArea].concat(selectedBlockNames);
          
          // 清空當前選擇（但保持購物車中的格子為綠色）
          selectedBlocks = [];
          selectedBlockNames = [];
          
          // 清空當前區域的選擇記錄
          if (currentSelectedArea) {
            areaSelections[currentSelectedArea] = [];
          }
          
          updateSelectedBlocks();
        }
      }
      
      function showNotification(message, type = 'success') {
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        
        // 設置通知內容
        notificationText.textContent = message;
        
        // 根據類型設置樣式
        if (type === 'error') {
          notification.classList.add('error');
        } else {
          notification.classList.remove('error');
        }
        
        // 重置位置和透明度
        notification.style.bottom = '7.5rem';
        notification.style.left = '50%';
        notification.style.transform = 'translateX(-50%) translateY(50px)';
        notification.style.opacity = '0';
        notification.style.pointerEvents = 'none';
        
        // 顯示通知
        setTimeout(() => {
          notification.style.opacity = '1';
          notification.style.transform = 'translateX(-50%) translateY(0px)';
        }, 50);
        
        // 2秒後消失
        setTimeout(() => {
          notification.style.opacity = '0';
          notification.style.transform = 'translateX(-50%) translateY(-10px)';
        }, 2000);
        
        // 完全隱藏
        setTimeout(() => {
          notification.style.pointerEvents = 'none';
          notification.classList.remove('error');
        }, 2500);
      }
      
      // 按鈕動畫效果 - 只在桌面版
      function setupButtonAnimations() {
        if (window.matchMedia('(hover: hover) and (pointer: fine)').matches) {
          // 清除按鈕動畫（有 button-bg-fill）
          const clearButton = document.getElementById('clear-btn');
          const clearButtonFill = clearButton.querySelector('.button-bg-fill');
          
          clearButton.addEventListener('mouseenter', function() {
            if (!this.disabled) {
              gsap.to(clearButtonFill, {
                height: '100%',
                duration: 0.5,
                ease: "power2.out"
              });
              
              // 文字顏色變化
              this.classList.add('white-text');
            }
          });
          
          clearButton.addEventListener('mouseleave', function() {
            if (!this.disabled) {
              gsap.to(clearButtonFill, {
                height: '0%',
                duration: 0.5,
                ease: "power2.out"
              });
              
              // 文字顏色恢復
              this.classList.remove('white-text');
            }
          });
        }
        
        // 加入清單按鈕已經有 CSS hover 效果，不需要額外 JavaScript 動畫
      }
      
      // 監聽購物車變化
      function syncCartState(shouldUpdateDisplay = true) {
        if (window.cartManager) {
          // 使用購物車管理器的 API 獲取所有區域格子狀態
          const areaBlocksArray = window.cartManager.getAllAreaBlocks();
          
          // 重置所有購物車狀態
          Object.keys(cartBlocks).forEach(areaKey => {
            cartBlocks[areaKey] = [];
          });
          
          // 將數組轉換為按區域分組的對象
          areaBlocksArray.forEach(blockInfo => {
            const { areaKey, blockName } = blockInfo;
            if (cartBlocks[areaKey]) {
              cartBlocks[areaKey].push(blockName);
            }
          });
          
          console.log('同步購物車狀態完成:', cartBlocks);
          
          // 只在需要時更新當前區域的視覺狀態
          if (shouldUpdateDisplay && currentSelectedArea) {
            updateAreaDisplay();
          }
        }
      }
      
      // 恢復購物車中格子的視覺狀態
      function restoreCartBlocksVisualState() {
        if (!currentSelectedArea) {
          console.log('沒有當前選中區域，跳過視覺狀態恢復');
          return;
        }
        
        const cartBlocksInCurrentArea = cartBlocks[currentSelectedArea] || [];
        
        if (cartBlocksInCurrentArea.length > 0) {
          console.log(`恢復區域 ${currentSelectedArea} 的購物車格子:`, cartBlocksInCurrentArea);
          
          cartBlocksInCurrentArea.forEach(blockName => {
            const cell = document.getElementById(blockName);
            if (cell) {
              if (cell.classList.contains('booked')) {
                console.log(`格子 ${blockName} 已被預訂，跳過視覺恢復`);
              } else {
                cell.classList.add('selected');
                console.log(`格子 ${blockName} 已恢復為綠色 (購物車狀態)`);
              }
            } else {
              console.log(`找不到格子元素: ${blockName}`);
            }
          });
        } else {
          console.log(`區域 ${currentSelectedArea} 沒有購物車格子需要恢復`);
        }
      }
      
      // 添加已提交訂單的區塊管理
      let submittedBlocks = {
        'courtyard': [],
        'corridor': [],
        'front-balcony': [],
        'back-balcony': [],
        'glass-wall': [],
        'pillar': []
      };
      
      // 模擬訂單提交後的狀態更新（實際使用時需要替換為後端API調用）
      function handleOrderSubmission() {
        // 將購物車中的區塊移至已提交狀態
        Object.keys(cartBlocks).forEach(areaKey => {
          submittedBlocks[areaKey] = submittedBlocks[areaKey].concat(cartBlocks[areaKey]);
        });
        
        // 清空購物車狀態
        Object.keys(cartBlocks).forEach(areaKey => {
          cartBlocks[areaKey] = [];
        });
      }
      
      // 等待購物車管理器準備就緒
      function waitForCartManager() {
        return new Promise((resolve) => {
          const checkCartManager = () => {
            if (window.cartManager && typeof window.cartManager.getAllAreaBlocks === 'function') {
              resolve();
            } else {
              setTimeout(checkCartManager, 50);
            }
          };
          checkCartManager();
        });
      }
      
      // 初始化：默認展開中庭
      document.addEventListener('DOMContentLoaded', async function() {
        // 等待購物車管理器準備就緒
        await waitForCartManager();
        console.log('購物車管理器已準備就緒');
        
        // 先設置默認選中的區域
        currentSelectedArea = 'courtyard';
        console.log('初始化：設置默認區域為', currentSelectedArea);
        
        // 立即同步購物車狀態（在展開動畫之前）
        syncCartState(false);
        
        openAccordion('courtyard');
        
        // 確保手風琴動畫完成後再載入區域顯示
        setTimeout(() => {
          // 載入區域顯示
          updateAreaDisplay();
          
          // 再次確保購物車狀態正確同步和視覺恢復
          setTimeout(() => {
            // 手動恢復購物車中格子的綠色狀態
            restoreCartBlocksVisualState();
            
            // 恢復默認區域的選擇狀態（排除已在購物車中的格子）
            const availableSelections = areaSelections['courtyard'].filter(blockName => 
              !cartBlocks['courtyard'].includes(blockName)
            );
            selectedBlockNames = [...availableSelections];
            selectedBlocks = [...selectedBlockNames];
            updateSelectedBlocks();
            
            console.log('初始化完成，當前區域:', currentSelectedArea);
            console.log('初始化完成，購物車狀態:', cartBlocks);
          }, 150);
        }, 600); // 等待手風琴展開動畫完成 (0.5s + 0.1s buffer)
        
        // 監聽購物車變化事件
        window.addEventListener('cartUpdated', function(event) {
          console.log('購物車更新事件觸發');
          syncCartState(false); // 先同步狀態
          // 延遲一點確保DOM更新完成後恢復視覺狀態
          setTimeout(() => {
            restoreCartBlocksVisualState();
          }, 100);
        });
        
        // 監聽跨頁面購物車變化
        window.addEventListener('storage', function(event) {
          if (event.key === 'sccd-rental-cart') {
            console.log('跨頁面購物車變化檢測，準備同步狀態...');
            // 延遲一點讓其他頁面的變更完全寫入
            setTimeout(() => {
              syncCartState(false); // 先同步狀態
              // 再延遲一點確保DOM更新完成後恢復視覺狀態
              setTimeout(() => {
                console.log('執行跨頁面視覺狀態恢復...');
                restoreCartBlocksVisualState();
              }, 150);
            }, 50);
          }
        });
        
        setupButtonAnimations(); // 初始化按鈕動畫
        
        // 為圖標添加hover效果 - 只在桌面版
        if (window.matchMedia('(hover: hover) and (pointer: fine)').matches) {
          const icons = document.querySelectorAll('.expand-icon');
          icons.forEach(icon => {
            icon.addEventListener('mouseenter', function() {
              if (this.classList.contains('plus')) {
                gsap.to(this, {
                  rotation: 90,
                  duration: 0.3,
                  ease: "power2.out"
                });
              }
            });
            
            icon.addEventListener('mouseleave', function() {
              if (this.classList.contains('plus')) {
                gsap.to(this, {
                  rotation: 0,
                  duration: 0.3,
                  ease: "power2.out"
                });
              }
            });
          });
        }
        
        // 開發用功能：提供測試函數
        window.testFunctions = {
          // 模擬訂單提交
          submitOrder: function() {
            handleOrderSubmission();
            updateAreaDisplay();
            showNotification('訂單已提交！購物車中的區塊現在變為紅色狀態。');
          },
          
          // 重置所有狀態
          resetAll: function() {
            Object.keys(cartBlocks).forEach(key => cartBlocks[key] = []);
            Object.keys(submittedBlocks).forEach(key => submittedBlocks[key] = []);
            Object.keys(areaSelections).forEach(key => areaSelections[key] = []);
            selectedBlocks = [];
            selectedBlockNames = [];
            updateAreaDisplay();
            updateSelectedBlocks();
            showNotification('所有狀態已重置！');
          },
          
          // 查看當前狀態
          showStatus: function() {
            console.log('購物車狀態：', cartBlocks);
            console.log('已提交訂單：', submittedBlocks);
            console.log('當前選擇：', selectedBlockNames);
            console.log('當前區域：', currentSelectedArea);
          },
          
          // 強制同步購物車狀態
          forceSync: function() {
            console.log('強制同步購物車狀態...');
            syncCartState(false);
            setTimeout(() => {
              restoreCartBlocksVisualState();
              console.log('強制同步完成');
            }, 100);
          },
          
          // 測試購物車管理器
          testCartManager: function() {
            if (window.cartManager) {
              console.log('購物車管理器可用');
              const allBlocks = window.cartManager.getAllAreaBlocks();
              console.log('購物車中的所有區域格子：', allBlocks);
            } else {
              console.log('購物車管理器不可用');
            }
          }
        };
        
        // 示範用：添加一些測試信息
        setTimeout(() => {
          console.log('頁面載入完成！');
          console.log('可用的測試功能：');
          console.log('- testFunctions.submitOrder() // 模擬提交訂單');
          console.log('- testFunctions.resetAll() // 重置所有狀態');
          console.log('- testFunctions.showStatus() // 查看當前狀態');
        }, 1000);
      });


    </script>


  </body>
</html> 