# SCCD 租借平???設置???

## ?? 概述

????帶您完? Google Sheets + Google Apps Script 後台???設置?程?

## ?? 設置步?

### 步? 1: ?建 Google Sheets

1. ?? [Google Sheets](https://sheets.google.com/)
2. ?建??試??
3. 將試算表?命?為 "SCCD租借平???庫"
4. **複製試?表? ID**（? URL 中獲??
   - URL ??: `https://docs.google.com/spreadsheets/d/[SPREADSHEET_ID]/edit`
   - 複製 `[SPREADSHEET_ID]` ??

### 步? 2: 設置 Google Apps Script

1. ?? [Google Apps Script](https://script.google.com/)
2. 點? "???
3. 將?案?????"SCCD租借平????
4. ?除?設??`Code.gs` ?容
5. ?`gas-backend.js` ?件?內容???製到 `Code.gs` ?
6. **??**: 修改?8 行? `SPREADSHEET_ID`?
   ```javascript
   const SPREADSHEET_ID = '??Google Sheets ID';
   ```

### 步? 3: ?署 Web App

1. ??Google Apps Script 編輯?中，???"?署" ??"???署作業"
2. ??類?：Web ?用程?
3. 設置以??數?
   - **??身?**: ??
   - **??存?權?使用??*: 任??
4. 點? "?署"
5. **複製 Web ?用程? URL**
6. 點? "??存?權?" 並????

### 步? 4: ?置?端 API

1. ?? `api-manager.js` ?件
2. 修改?6 行? `GAS_WEB_APP_URL`?
   ```javascript
   this.GAS_WEB_APP_URL = '??Web?用程?URL';
   ```

### 步? 5: ?新 HTML ?件

????要????? HTML ?件中添??API 管???

```html
<!-- ??</body> 標籤?添??-->
<script src="api-manager.js"></script>
```

## ???資?庫??

系統?自?創建以下工作表?

### 設?清單 (EQUIPMENT)
| 欄? | 說? |
|------|------|
| 設?ID | ??識別?|
| 設??稱 | 設??顯示??|
| 類別 | 設??? |
| ???| ?現?缺貨 |
| ?? | ?用?? |
| ?? | 租借押??|
| ?述 | 設?詳細說? |
| ??URL | 設?????? |
| 建??? | 記?建??? |
| ?新?? | ?後更????|

### 訂單記? (ORDERS)
| 欄? | 說? |
|------|------|
| 訂單ID | ??識別?|
| ?戶ID | 下單?戶 |
| ?戶姓? | ?戶姓? |
| ?戶信箱 | ?絡信箱 |
| ?戶?話 | ?絡?話 |
| ??清單 | JSON ???????|
| 總??| 訂單總押??|
| 租借?始日??| ??使用?? |
| 租借??日??| 歸??? |
| ???| 待審??已確?已???已??|
| 建??? | 訂單建??? |
| 審核人員 | ??人員 |
| ?註 | 額?說? |
| 使用?? | 租借用??|
| 使用?? | 使用?? |
| ?新?? | ?後更????|

### ?戶資? (USERS)
| 欄? | 說? |
|------|------|
| ?戶ID | ??識別?|
| 姓? | ?實姓? |
| 信箱 | ???件 |
| ?話 | ?絡?話 |
| 學? | 學?編? |
| 年? | 就?年? |
| 科系 | 就?科系 |
| 註??? | 帳?建??? |
| ???| ?/?用 |
| 總??次??| 歷史租借統?|
| ??次數 | ??記? |
| 緊急聯絡人 | 緊急聯絡方?|
| Line ID | Line ?絡?? |

### 庫?記? (INVENTORY)
| 欄? | 說? |
|------|------|
| 記?ID | ??識別?|
| 設?ID | ??設? |
| 變??數??| 變??庫?|
| 變?後數??| 變?後庫?|
| 變?類? | rent/return/adjust |
| ??訂單ID | ?聯訂單 |
| ?? | 變??? |
| ?註 | 變?說? |

### ??記? (BOOKINGS)
| 欄? | 說? |
|------|------|
| ??ID | ??識別?|
| ?戶ID | ???戶 |
| ?戶姓? | ?戶姓? |
| 資?類? | equipment/space |
| 資?ID | 資?識別?|
| 資??稱 | 資??稱 |
| ???? | ?????? |
| 結??? | ??結??? |
| 使用?? | 使用?? |
| ???| 待審??已確?已???已??|
| 建??? | ??建??? |
| ?註 | 額?說? |

## ? API 使用??

### ?端調用示?

```javascript
// ????設??
const equipment = await window.apiManager.getEquipment();

// ?建訂單
const orderData = {
  items: [
    { id: 'speaker-clamp-light', name: '黑色?叭夾?', quantity: 1, deposit: 500 }
  ],
  totalAmount: 500,
  rentalDates: {
    start: '2025-01-15',
    end: '2025-01-16'
  },
  purpose: '課?作業',
  location: '?影棚A'
};

const result = await window.apiManager.createOrder(orderData);

// ???戶訂單
const orders = await window.apiManager.getOrders('USER_ID');

// ?新庫?
await window.apiManager.updateInventory('speaker-clamp-light', 1, 'rent');
```

## ?? 權?設置

### Google Sheets 權?
1. 確? Google Apps Script ?????您??Google Sheets
2. 如?要其他人管?資?，可以??Google Sheets 並給予編輯???

### Google Apps Script 權?
1. ?署?選??"??存?權?使用?? 任??
2. ??許您?網站?端呼??API

## ? 測試設置

### 測試 Google Apps Script

1. ??GAS 編輯?中?? `testGetEquipment` ?數
2. 點? "??"
3. 檢查??記??否?錯?

### 測試?端??

1. ???覽???者工??
2. ?控?台輸入?
   ```javascript
   window.apiManager.getEquipment().then(console.log);
   ```
3. ?該?到設????錯誤???

## ?? ???設?數??

?可以??在 Google Sheets ??"設?清單" 工?表中添?????，?使用以????

```javascript
// ??GAS 中?行?始??數
function initializeEquipment() {
  const sheet = getSheet(SHEETS.EQUIPMENT);
  
  const equipmentData = [
    ['speaker-clamp-light', '黑色?叭夾?', '?叭夾?', '?現?, 3, 500, '?款黑色?叭夾?專為媒?製??設?, 'Images/Extension Cord.webp', new Date(), new Date()],
    ['extension-cord', '專業延長?, '線?', '?現?, 5, 500, '高?質?業延??，適?於?種?影設?', 'Images/Extension Cord.webp', new Date(), new Date()]
  ];
  
  equipmentData.forEach(row => {
    sheet.appendRow(row);
  });
}
```

## ? 常???

### ?? 1: "Script function not found"
**???**: 確? GAS ?已正確?存並?署

### ?? 2: "Access denied" 
**???**: ?新檢查權?設置，確保已完???

### ?? 3: "Invalid SPREADSHEET_ID"
**???**: 確? Google Sheets ID ?否?複製

### ?? 4: CORS ?誤
**???**: 確? Web App ?署設置??"任?人都????

## ? ???能

### ?件?知
?以??GAS 中添?郵件通知?能?

```javascript
function sendNotificationEmail(to, subject, body) {
  GmailApp.sendEmail(to, subject, body);
}
```

### 定??份
設置定?觸發?進?資??份?

```javascript
function createBackup() {
  const ss = SpreadsheetApp.openById(SPREADSHEET_ID);
  const copy = ss.copy('?份_' + new Date().toISOString());
  // 將?份?案移?到??資??
}
```

## ? 下??

1. 完??本設置並測試???
2. ???要自訂工作表結?
3. 添???業??輯
4. 設置?件?知
5. ?慮添?管?後台?面

如?任???，???Google Apps Script 官方?件?聯繫??者?
